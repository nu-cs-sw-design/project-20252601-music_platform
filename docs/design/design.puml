@startuml
title UC1 + Piano Roll + Loop Model (no rendering yet)

package View {
    class Main {
        +{static} main(args: String[]): void
    }

    class MainView {
        -pianoRollView: PianoRollView

        +MainView()
        +showMainScreen(): void
        +showAudioError(): void
    }

    class PianoRollView {
        +PianoRollView()
        +setMeasures(measures: int): void
    }
}

package Controller {
    class AppController {
        -audioEngine: AudioEngine
        -mainView: MainView
        -currentLoop: Loop

        +AppController(mainView: MainView, audioEngine: AudioEngine)
        +startApplication(): void
    }

    package engine {
        interface Instrument {
            +noteOn(pitch: int, vel: int): void
            +noteOff(pitch: int): void
            +close(): void
        }

        class PianoInstrument implements Instrument {
            +PianoInstrument()
            +noteOn(pitch: int, vel: int): void
            +noteOff(pitch: int): void
            +close(): void
        }

        class AudioEngine {
            -instrument: Instrument
            +AudioEngine()
            +initialize(): boolean
            +noteOn(pitch: int, vel: int): void
            +noteOff(pitch: int): void
        }
    }
}

package Model {
    class Loop {
        -notes: List<LoopNote>
        -measures: int

        +Loop(measures: int)
        +addNote(note: LoopNote): void
        +removeNote(note: LoopNote): void
        +getNotes(): List<LoopNote>
        +getMeasures(): int
    }

    class LoopNote {
        -pitch: int
        -startBeat: double
        -durationBeats: double
        -velocity: int

        +getPitch(): int
        +getStartBeat(): double
        +getDurationBeats(): double
        +getVelocity(): int
    }

}

' --- Relationships ---

' Startup wiring
Main ..> AppController : "creates and calls"
Main ..> MainView
Main ..> AudioEngine

' View wiring
MainView --> PianoRollView : "contains"

' Controller wiring
AppController --> MainView
AppController --> AudioEngine
AppController --> Loop : "currentLoop"

' Engine wiring
Controller.engine.AudioEngine --> Controller.engine.Instrument : "default piano"

' Model wiring
Loop --> LoopNote : "contains notes"

@enduml
